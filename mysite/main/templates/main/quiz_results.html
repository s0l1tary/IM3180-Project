{% extends "register/base.html" %}
{% block title %}Results · DeepLearn{% endblock %}

{% block content %}
  {% include "main/navbar.html" %}

  <div class="container py-4">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <h1 class="h3 mb-0">Your Results</h1>
      <span class="badge bg-primary">{{ difficulty|title }}</span>
    </div>

    <div class="alert alert-info">
      Score: <strong>{{ score }}</strong> / {{ total }}
    </div>

    {% for r in results %}
      <div class="card mb-3 p-3">
        <h5 class="mb-2">{{ forloop.counter }}. {{ r.question.text }}</h5>
        <ul class="mb-0">
          {% for opt in r.options %}
            <li
              class="{% if opt.id|stringformat:'s' == r.correct_id|stringformat:'s' %}text-success{% endif %}
                     {% if opt.id|stringformat:'s' == r.chosen_id|stringformat:'s' and not r.is_correct %}text-danger{% endif %}">
              {{ opt.text }}
              {% if opt.id|stringformat:'s' == r.correct_id|stringformat:'s' %} ✓ Correct{% endif %}
              {% if opt.id|stringformat:'s' == r.chosen_id|stringformat:'s' and not r.is_correct %} (your answer){% endif %}
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endfor %}

    <div class="d-flex gap-2">
      <a class="btn btn-primary" href="{% url 'quiz' %}?difficulty={{ difficulty }}">Try again</a>
      <a class="btn btn-outline-secondary" href="{% url 'quiz' %}">Change difficulty</a>
    </div>
  </div>
{% endblock %}
